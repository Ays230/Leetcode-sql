602. Friend Requests II: Who Has the Most Friends
with new as (
    select requester_id as id from RequestAccepted
    union all
    select accepter_id from RequestAccepted 
)

select id ,count(id) as num from new
group by id order by num desc limit 1

607. Sales Person
select SalesPerson.name from SalesPerson
except
select SalesPerson.name from orders
left join company using(com_id)
left join SalesPerson using(sales_id)
where company.name='RED'

610. Triangle Judgement
select x,y,z,
case 
when
x+y>z and y+z>x and z+x>y then 'Yes'
else 'No'
end as triangle
from Triangle;

619. Biggest Single Number
select max(num) as num from (select num from mynumbers group by num having count(num) = 1 )

620. Not Boring Movies
select id,movie,description,rating from cinema
where mod(id,2)!=0 and description != 'boring' order by rating desc ;

626. Exchange Seats
select 
case 
when id%2=1 and id = (select max(id) from seat) then id
when id%2=0 then id-1
when id%2=1 then id+1
end as id ,student
from seat 
order by id

627. Swap Sex of Employees
update salary set sex = case 
when sex = 'm' then 'f'
when sex = 'f' then 'm'
end;


1045. Customers Who Bought All Products
select customer_id from Customer 
join product using(product_key)
group by customer_id 
having count(distinct(product_key))=(select count(*)from product);

1050. Actors and Directors Who Cooperated At Least Three Times
select actor_id,director_id from ActorDirector 
group by actor_id,director_id having count(*)>=3

1068. Product Sales Analysis I
select product_name,year,price from sales s
join product p on s.product_id=p.product_id